!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("BusinessManagerAPI"),require("React"),require("ReactDOM"),require("Sentry"),require("reactModuleContainer"),require("_").throttle):"function"==typeof define&&define.amd?define("AutoCMS",["BusinessManagerAPI","React","ReactDOM","Sentry","reactModuleContainer"],e):"object"==typeof exports?exports.AutoCMS=e(require("BusinessManagerAPI"),require("React"),require("ReactDOM"),require("Sentry"),require("reactModuleContainer"),require("_").throttle):(t.AutoCMS=t.AutoCMS||{},t.AutoCMS["auto-cms-bm-module"]=e(t.BusinessManagerAPI,t.React,t.ReactDOM,t.Sentry,t.reactModuleContainer,t._.throttle))}(this,(t,e,r,n,o,a)=>(()=>{var i={4883:t=>{"use strict";t.exports=e},35386:t=>{"use strict";t.exports=JSON.parse('{"oK":"auto-cms-page-component","Tq":"wix-databases-lazy-page-component","EV":"auto-cms.getActiveExperiments","$0":"auto-cms.initPanoramaClient","jm":"auto-cms.getPanoramaClient"}')},39907:t=>{var e,r,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,c=[],u=!1,l=-1;function d(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&f())}function f(){if(!u){var t=i(d);u=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function h(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new p(t,e)),1!==c.length||u||i(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},41619:t=>{"use strict";t.exports=n},45507:e=>{"use strict";e.exports=t},60374:t=>{"use strict";t.exports=o},62593:(t,e,r)=>{"use strict";r.d(e,{AutoCMSLazyPageComponent:()=>s});var n=r(60374);const o=JSON.parse('{"l":"auto-cms-externals"}');var a=r(35386),i=r(39907);i.env.IS_JEST,i.env.IS_BO;class s extends n.ReactLazyComponent{constructor(t){const e=[`${t.config.topology.autoCmsStaticsUrl}${a.oK}.bundle.css`];super(t,{files:[[`${t.config.topology.autoCmsStaticsUrl}${o.l}.js`,`${t.config.topology.autoCmsStaticsUrl}${a.oK}.js`,...e]],component:a.oK,resolve:async()=>{"embedded-view"!==t.integration&&n.ModuleRegistry.invoke(a.$0,{metaSiteId:t.metaSiteId,userId:t.userId});return{experiments:await n.ModuleRegistry.invoke(a.EV)}}})}}},72527:t=>{"use strict";t.exports=a},81845:t=>{"use strict";t.exports=r},86125:function(t,e,r){var n;t=r.nmd(t),function(){var o=e,a=(t&&t.exports,"object"==typeof r.g&&r.g);a.global!==a&&a.window;var i=function(t){this.message=t};(i.prototype=new Error).name="InvalidCharacterError";var s=function(t){throw new i(t)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,l={encode:function(t){t=String(t),/[^\0-\xFF]/.test(t)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var e,r,n,o,a=t.length%3,i="",u=-1,l=t.length-a;++u<l;)e=t.charCodeAt(u)<<16,r=t.charCodeAt(++u)<<8,n=t.charCodeAt(++u),i+=c.charAt((o=e+r+n)>>18&63)+c.charAt(o>>12&63)+c.charAt(o>>6&63)+c.charAt(63&o);return 2==a?(e=t.charCodeAt(u)<<8,r=t.charCodeAt(++u),i+=c.charAt((o=e+r)>>10)+c.charAt(o>>4&63)+c.charAt(o<<2&63)+"="):1==a&&(o=t.charCodeAt(u),i+=c.charAt(o>>2)+c.charAt(o<<4&63)+"=="),i},decode:function(t){var e=(t=String(t).replace(u,"")).length;e%4==0&&(e=(t=t.replace(/==?$/,"")).length),(e%4==1||/[^+a-zA-Z0-9/]/.test(t))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n,o=0,a="",i=-1;++i<e;)n=c.indexOf(t.charAt(i)),r=o%4?64*r+n:n,o++%4&&(a+=String.fromCharCode(255&r>>(-2*o&6)));return a},version:"1.0.0"};void 0===(n=function(){return l}.call(e,r,e,t))||(t.exports=n)}()}},s={};function c(t){var e=s[t];if(void 0!==e)return e.exports;var r=s[t]={id:t,loaded:!1,exports:{}};return i[t].call(r.exports,r,r.exports,c),r.loaded=!0,r.exports}c.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return c.d(e,{a:e}),e},c.d=(t,e)=>{for(var r in e)c.o(e,r)&&!c.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),c.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),c.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);return(()=>{"use strict";var t=c(45507),e=c(60374),r=c(4883),n=c.n(r),o=c(81845),a=c(35386);const i=JSON.parse('{"o0":"autoCMS.embed"}'),s=()=>e.ModuleRegistry.registerMethod(i.o0,()=>t=>{(({node:t,configuration:r,historyType:i="memory"})=>{const s=e.ModuleRegistry.component(a.Tq);if(!s)throw new Error("AutoCMSPageComponent is undefined");if(!t)throw new Error("Node to render AutoCMSPageComponent is undefined.");(0,o.render)(n().createElement(s,{historyType:i,configuration:r,integration:"embedded-view"}),t)})(t)});var u=c(62593),l=function(t,e){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},l(t,e)};function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var f=function(){return f=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},f.apply(this,arguments)};function p(t,e,r,n){return new(r||(r=Promise))(function(o,a){function i(t){try{c(n.next(t))}catch(t){a(t)}}function s(t){try{c(n.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(i,s)}c((n=n.apply(t,e||[])).next())})}function h(t,e){var r,n,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=e.call(t,a)}catch(t){s=[6,t],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}Object.create;function g(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create;"function"==typeof SuppressedError&&SuppressedError;var m;!function(t){t.Default="",t.OwnerAccount="owner-account"}(m||(m={}));var b="__WIXEXP_USE_NEW_API",y="__WIXEXP_CONDUCTION_METHOD_",v="__WIXEXP_OWNER_ACCOUNT_ID_",E="__WIXEXP_LOGGED_IN_USER_ID_";function I(t,e,r){var n,o;if("undefined"!=typeof self)if("function"==typeof r){if(void 0!==r(self[e]))return(n={})[t]=r(self[e]),n}else if(typeof self[e]===r)return(o={})[t]=self[e],o;return{}}var S=function(t){return Object.keys(m).filter(function(e){return m[e]===t}).length>0?t:void 0};function C(t){return function(t){return t.conductionMethod===m.OwnerAccount&&t.siteOwnerId&&t.loggedInUserId}(t)?{forSiteOwner:{siteOwnerId:t.siteOwnerId,loggedInUserId:t.loggedInUserId}}:{}}var T=function(t){return"string"==typeof t&&""!==t};function A(t){void 0===t&&(t={});var e=t.forSiteOwner,r=t.forSiteVisitors,n=t.overrideCriteria,o="";if(["forSiteOwner","forSiteVisitors"].reduce(function(e,r){return t[r]?e+1:e},0)>1)throw new Error('Only one of "forSiteOwner" or "forSiteVisitors" is accepted.');return e&&(o+=function(t){return T(t.loggedInUserId)&&T(t.siteOwnerId)?"&"+"requestContext.forSiteOwner.loggedInUserId=".concat(t.loggedInUserId,"&")+"requestContext.forSiteOwner.siteOwnerId=".concat(t.siteOwnerId):""}(e)),r&&(o+=function(t){return T(t.visitorId)&&T(t.siteOwnerId)?"&"+"requestContext.forSiteVisitors.visitorId=".concat(t.visitorId,"&")+"requestContext.forSiteVisitors.siteOwnerId=".concat(t.siteOwnerId):""}(r)),n&&(o+=function(t){return T(t.entityId)?"&requestContext.overrideCriteria.entityId=".concat(t.entityId):""}(n)),o}function R(t){if("string"==typeof t)try{return JSON.parse(t)}catch(t){}return t}var w={conductAllInScope:"/_api/wix-laboratory-server/v1/laboratory/platform/conductAllInScope",conductExperiment:"/_api/wix-laboratory-server/v1/laboratory/platform/conductExperiment"},_={conductAllInScope:"/_api/wix-laboratory-server/laboratory/conductAllInScope",conductExperiment:"/_api/wix-laboratory-server/laboratory/conductExperiment"};function P(t,e){return-1!==t.indexOf(e?w.conductAllInScope:_.conductAllInScope)}var D=function(t,e,r){return void 0===t&&(t=""),void 0===e&&(e=""),void 0===r&&(r=!1),r?"".concat(w.conductExperiment,"?key=").concat(encodeURIComponent(t),"&fallbackValue=").concat(encodeURIComponent(e)):"".concat(_.conductExperiment,"?key=").concat(encodeURIComponent(t),"&fallback=").concat(encodeURIComponent(e))};function O(t,e,r){var n="".concat(D(e,"",r));return t.includes(n)}var x=function(){function t(){this.urlMap=new Map,this.pendingUrlMap=new Map}return t.prototype.addUrlRequest=function(t,e){return p(this,void 0,void 0,function(){var r=this;return h(this,function(n){switch(n.label){case 0:return this.pendingUrlMap.set(t,e),[4,e.then(function(e){return r.addUrlResponse(t,e)})];case 1:return n.sent(),[2]}})})},t.prototype.addUrlResponse=function(t,e){this.urlMap.set(t,e)},t.prototype.getUrlResponse=function(t){return this.urlMap.get(t)},t.prototype.getUrlRequest=function(t){return this.pendingUrlMap.get(t)},t.prototype.getExperimentValue=function(t,e){var r,n;try{for(var o=g(this.urlMap.keys()),a=o.next();!a.done;a=o.next()){var i=a.value;if(O(i,t,e))return this.urlMap.get(i);if(P(i,e)){var s=R(this.urlMap.get(i));if("object"==typeof s&&t in s)return s[t]}}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t}();!function(){function t(){}t.prototype.addUrlRequest=function(){},t.prototype.addUrlResponse=function(){},t.prototype.getUrlResponse=function(){},t.prototype.getUrlRequest=function(){},t.prototype.getExperimentValue=function(){}}();function M(){return void 0===self.experimentsCacheV2&&(self.experimentsCacheV2=new x),self.experimentsCacheV2}function k(){return"object"==typeof self?self:c.g}function N(t){const e=function(t){return function(){const t=function(){if("object"==typeof document)return document}();if(t&&t.cookie)return decodeURIComponent(t.cookie).split(";");return[]}().filter(e=>t===e.split("=")[0].trim())[0]}(t);return e?e.split("=")[1]:""}const U="x-xsrf-token";const L="x-wix-brand";function B(){const t=function(){const t=k();if(t&&t.commonConfig&&"string"==typeof t.commonConfig.brand)return t.commonConfig.brand;return""}();return{[L]:t}}function F(){return function(){const t=k();if(t&&t.consentPolicyManager&&"function"==typeof t.consentPolicyManager._getConsentPolicyHeader)return t.consentPolicyManager._getConsentPolicyHeader();return}()||function(){const t=k();if(t&&t.Wix&&t.Wix.Utils&&"function"==typeof t.Wix.Utils._getConsentPolicyHeader)return t.Wix.Utils._getConsentPolicyHeader();return}()||{}}var H=c(39907);function V(){return void 0!==H&&null!=H.versions?.node}var j=c(39907);function W(t){const e=V()?j.env.ARTIFACT_ID??j.env.APP_NAME??"":"";return{"X-Wix-Client-Artifact-Id":t??(V()&&(H.env.TEAMCITY_VERSION||H.env.BUILDKITE)?"":e)}}const q=["consentPolicy","consentPolicyHeader"],$="commonConfig",X={bsi:"BSI"};const K=()=>{const t=function(){const t=k(),e=t?.commonConfig;if(!e)return null;const r={};let n=!1;return Object.keys(e).forEach(t=>{const o=X[t];o?(r[o]=e[t],n=!0):q.indexOf(t)<0&&"function"!=typeof e[t]&&(r[t]=e[t],n=!0)}),n?r:null}(),e=t?JSON.stringify(t):"";return{[$]:encodeURIComponent(e)}};var G=c(86125),z=c.n(G);const J="x-wix-linguist";function Q({lang:t,locale:e,isPrimaryLanguage:r,signedInstance:n}){if(function({lang:t,locale:e,isPrimaryLanguage:r}){return t&&e&&/^(true|false)$/.test(r?.toString()||"")}({lang:t,locale:e,isPrimaryLanguage:r})){const o=function(t){try{const e=t?.startsWith("wixcode")?t?.split(".")[2]:t?.split(".")[1];if(e)return JSON.parse(z().decode(e)).instanceId}catch(t){}}(n);if(void 0!==o)return{[J]:[t,e,r?.toString(),o].join("|")}}return{}}Error;class Y extends Error{constructor(t,e,r){super(`WixHeadersValidationError: expected ${e} to be ${t} but got ${JSON.stringify(r)}`)}}function Z(t={}){!function(t){(function(t,e){if("boolean"!=typeof e)throw new Y("boolean",t,e)})("opts.csrf",t.csrf),function(t,e){if("string"!=typeof e)throw new Y("string",t,e)}("opts.signedInstance",t.signedInstance)}(t={csrf:!0,signedInstance:"",...t});const e=[B(),F(),(r=t.signedInstance,{authorization:r}),W(t.artifactId),K(),Q({signedInstance:t.signedInstance,...t.multilingualOptions})];var r;return t.csrf&&e.push(function(){const t=N("XSRF-TOKEN");return{[U]:t}}()),e.filter(t=>Object.values(t).every(t=>t)).reduce((t,e)=>({...t,...e}),{})}var tt=function(){function t(t){var e;this.experiments=null!==(e=t.experiments)&&void 0!==e?e:{}}return t.prototype.get=function(t){return this.experiments[t]},t.prototype.enabled=function(t){return"true"===this.get(t)},t.prototype.pending=function(){return!1},t.prototype.ready=function(){return Promise.resolve()},t.prototype.all=function(){return this.experiments},t}(),et=function(){},rt=function(t){function e(e){void 0===e&&(e={});var r=t.call(this,e)||this,n=f(f(f(f({},I("useNewApi",b,"boolean")),I("conductionMethod",y,S)),I("siteOwnerId",v,"string")),I("loggedInUserId",E,"string"));return r.useNewApi=void 0!==e.useNewApi?e.useNewApi:n.useNewApi||!1,r.experiments=e.experiments||{},r.loaders=new Map,r.baseUrl=(r.useNewApi,e.baseUrl||""),r.requestContext=e.requestContext||C(n),r.onError=e.onError||et,e.scope&&r.load(e.scope),e.scopes&&e.scopes.forEach(r.load.bind(r)),r}return d(e,t),e.prototype.add=function(t){this.experiments=f(f({},this.experiments),t)},e.prototype._addLoader=function(t,e){var r=this;return this.loaders.set(t,e),e.then(function(){r.loaders.delete(t)}),e},e.prototype._getUrlWithFallback=function(t,e){var r=this,n=M().getUrlResponse(t);if(void 0!==n)return Promise.resolve(n);var o=M().getUrlRequest(t);if(void 0!==o)return o;var a=this.loaders.get(t);if(void 0!==a)return a;var i=function(t){return new Promise(function(e,r){var n=Z(),o=new XMLHttpRequest;o.open("GET",t,!0),Object.keys(n).forEach(function(t){return o.setRequestHeader(t,n[t])}),o.responseType="text",o.withCredentials=!0,o.onload=function(){o.status>=200&&o.status<400?e(o.responseText):r(new Error("Failed to load ".concat(t,", status ").concat(o.status)))},o.onerror=function(){return r(new Error("Failed to load ".concat(t)))},o.send()})}(t).catch(function(t){return r.onError(t),e});return M().addUrlRequest(t,i),i},e.prototype.load=function(t){var e=this,r=function(t,e){return void 0===t&&(t=""),void 0===e&&(e=!1),e?"".concat(w.conductAllInScope,"?scope=").concat(encodeURIComponent(t)):"".concat(_.conductAllInScope,"?scope=").concat(encodeURIComponent(t))}(t,this.useNewApi),n=this.useNewApi?A(this.requestContext):"",o="".concat(this.baseUrl).concat(r).concat(n),a=this._getUrlWithFallback(o,"{}").then(function(t){return R(t)}).then(function(t){return e.useNewApi?t.values:t}).then(function(t){return e.add(t),t});return this._addLoader(o,a)},e.prototype.conduct=function(t,e){var r=this,n=M().getExperimentValue(t,this.useNewApi);if(void 0!==n)return this._addConductResult(t,n);var o=D(t,e,this.useNewApi),a=this.useNewApi?A(this.requestContext):"",i="".concat(this.baseUrl).concat(o).concat(a),s=this._getUrlWithFallback(i,null!=e?e:"").then(function(e){return r._addConductResult(t,e)});return this._addLoader(i,s)},e.prototype.pending=function(){return!!this.loaders.size},e.prototype.ready=function(){return Promise.all(Array.from(this.loaders.values()))},e.prototype._addConductResult=function(t,e){var r,n=this.useNewApi?JSON.parse(e).value:e;return this.add(((r={})[t]=n,r)),Promise.resolve(n)},e}(tt);const nt=async()=>{const t=new rt({scope:"wix-code"});return await t.ready(),t.all()};function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function at(t){var e=function(t,e){if("object"!=ot(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ot(e)?e:e+""}function it(t,e,r){return(e=at(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const st=(t,e)=>{const r=e?e.prototype:Object.getPrototypeOf(t),n=Object.getOwnPropertyNames(r);for(const e of n)"constructor"!==e&&"function"==typeof r[e]&&(t[e]=r[e].bind(t))},ct={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let ut;const lt=new Uint8Array(16);function dt(){if(!ut&&(ut="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ut))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ut(lt)}const ft=[];for(let t=0;t<256;++t)ft.push((t+256).toString(16).slice(1));function pt(t,e=0){return ft[t[e+0]]+ft[t[e+1]]+ft[t[e+2]]+ft[t[e+3]]+"-"+ft[t[e+4]]+ft[t[e+5]]+"-"+ft[t[e+6]]+ft[t[e+7]]+"-"+ft[t[e+8]]+ft[t[e+9]]+"-"+ft[t[e+10]]+ft[t[e+11]]+ft[t[e+12]]+ft[t[e+13]]+ft[t[e+14]]+ft[t[e+15]]}const ht=function(t,e,r){if(ct.randomUUID&&!e&&!t)return ct.randomUUID();const n=(t=t||{}).random||(t.rng||dt)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=n[t];return e}return pt(n)};class gt{constructor(){this.transactionStartTimes={},this.phaseStartTimes={}}createKey(...t){return t.filter(t=>!!t).join(" | ")}markTransactionStart(t,e,r,n){const o=this.createKey(t,e,r,n);this.transactionStartTimes[o]=Date.now()}markTransactionFinish(t,e,r,n){const o=this.createKey(t,e,r,n),a=Date.now(),i=this.transactionStartTimes[o]||a,s=Math.round(a-i);return this.transactionStartTimes[o]=0,s}markPhaseStart(t,e,r){const n=this.createKey(t,e,r);this.phaseStartTimes[n]=Date.now()}markPhaseFinish(t,e,r){const n=this.createKey(t,e,r),o=Date.now(),a=this.phaseStartTimes[n]||o,i=Math.round(o-a);return this.phaseStartTimes[n]=0,i}}const mt=()=>new gt;class bt{constructor(){this.sessionId="",this.reporter=null,this.batchQueue=null,this.durationTracker=mt(),this.state=new Map,this.sessionStart=Date.now()}getSessionId(){return this.sessionId=this.sessionId||ht(),this.sessionId}setSessionId(t){this.sessionId=t}getSessionTime(){return Date.now()-this.sessionStart}getReporter(){return this.reporter}setReporter(t){this.reporter=t}initBatchQueue(t){this.batchQueue=this.batchQueue??t}getBatchQueue(){return this.batchQueue}getDurationTracker(){return this.durationTracker}getStateValue(t){return this.state.get(t)}setStateValue(t,e){this.state.set(t,e)}clearState(){this.state.clear(),this.durationTracker=mt()}}const yt=()=>new bt,vt=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((t,e)=>Object.entries(e??{}).reduce((t,e)=>{let[r,n]=e;return void 0===t[r]&&void 0!==n&&(t[r]=n),t},t),{})},Et=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];const o=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return[...new Set(e.flat()).values()]}(...r.map(t=>Object.keys(t??{}))),a=[t,...r];return o.reduce((t,e)=>{const r=a.map(t=>null==t?void 0:t[e]),n=vt(...r);var o;Object.values(n).filter(t=>void 0!==t).length>0?(t=t??{})[e]=n:null==(o=t)||delete o[e];return t},t?{...t}:t)};var It,St,Ct,Tt;!function(t){t.SuccessRate="SuccessRate",t.SuccessRateQuality="SuccessRateQuality",t.Duration="Duration",t.ErrorRate="ErrorRate"}(It||(It={})),function(t){t.Alerting="alerting",t.Ok="ok"}(St||(St={})),function(t){t.Info="INFO",t.Warn="WARN",t.Error="ERROR",t.Debug="DEBUG"}(Ct||(Ct={})),function(t){t.Start="START",t.Finish="FINISH"}(Tt||(Tt={}));const At={ComponentLoad:"PANORAMA_COMPONENT_LOAD",ComponentPhase:"PANORAMA_COMPONENT_PHASE"};var Rt,wt;!function(t){t.Standalone="standalone",t.BusinessManager="business-manager",t.Viewer="viewer",t.Editor="editor",t.EditorSettings="editor:settings",t.Mobile="mobile",t.Standards="standards"}(Rt||(Rt={})),function(t){t.Fatal="fatal",t.Error="error",t.Warning="warning",t.Log="log",t.Info="info",t.Debug="debug",t.Critical="critical"}(wt||(wt={}));class _t{constructor(t,e){this.baseClient=t,this.options=e,st(this)}reportError(t,e){this.baseClient.reportError(t,e,this.options)}addBreadcrumb(t){this.baseClient.addBreadcrumb(t)}}class Pt{constructor(t){this.baseClient=t,st(this)}info(t,e){this.baseClient.log(Ct.Info,t,e)}warn(t,e){this.baseClient.log(Ct.Warn,t,e)}error(t,e){this.baseClient.log(Ct.Error,t,e)}debug(t,e){this.baseClient.log(Ct.Debug,t,e)}}class Dt{constructor(t,e,r){if(this.baseClient=t,this.name=e,this.options=r,!(t=>!Object.values(At).includes(t))(e))throw new Error(`"${e}" is an internal transaction and can't be used`);this.baseClient=t,st(this)}start(t,e){return this.baseClient.reportTransactionStart(this.name,vt(e,this.options),t)}finish(t,e){return this.baseClient.reportTransactionFinish(this.name,vt(e,this.options),t)}}class Ot{constructor(t){let{baseClient:e}=t;it(this,"baseClient",void 0),this.baseClient=e,st(this)}transaction(t,e){return new Dt(this.baseClient,t,e)}errorMonitor(t){return new _t(this.baseClient,t)}logger(){return new Pt(this.baseClient)}}let xt=function(t){return t[t.afterCreateClientForComponent=0]="afterCreateClientForComponent",t[t.beforeReport=1]="beforeReport",t[t.beforeReportTransactionStart=2]="beforeReportTransactionStart",t[t.afterReportTransactionStart=3]="afterReportTransactionStart",t[t.beforeReportTransactionFinish=4]="beforeReportTransactionFinish",t[t.afterReportTransactionFinish=5]="afterReportTransactionFinish",t[t.beforeReportPhaseStart=6]="beforeReportPhaseStart",t[t.afterReportPhaseStart=7]="afterReportPhaseStart",t[t.beforeReportPhaseFinish=8]="beforeReportPhaseFinish",t[t.afterReportPhaseFinish=9]="afterReportPhaseFinish",t[t.beforeReportError=10]="beforeReportError",t[t.afterReportError=11]="afterReportError",t[t.beforeAddBreadcrumb=12]="beforeAddBreadcrumb",t[t.afterAddBreadcrumb=13]="afterAddBreadcrumb",t[t.beforeReportLog=14]="beforeReportLog",t[t.afterReportLog=15]="afterReportLog",t[t.beforeUnhandledError=16]="beforeUnhandledError",t}({});class Mt{constructor(){it(this,"subscribers",{})}tap(t,e){this.subscribers[t]=this.subscribers[t]||[],this.subscribers[t].push(e)}invoke(t){const e=this.subscribers[t];if(!e)return!0;for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];for(const t of e)if(!1===t(...n))return!1;return!0}}class kt{constructor(t,e){this.name=t,this.baseClient=e,this.baseClient=e,st(this)}start(t){return this.baseClient.reportPhaseStart(this.name,t)}finish(t){return this.baseClient.reportPhaseFinish(this.name,t)}}class Nt{constructor(t){let{hooksManager:e,baseClient:r}=t;it(this,"baseClient",void 0),it(this,"hooksManager",void 0),this.baseClient=r,this.hooksManager=e,st(this)}onUnhandledError(t){this.hooksManager.tap(xt.beforeUnhandledError,t)}reportLoadStart(t,e){const{ComponentLoad:r}=At;return this.baseClient.reportTransactionStart(r,e,t)}reportLoadFinish(t,e){const{ComponentLoad:r}=At;return this.baseClient.reportTransactionFinish(r,e,t)}phase(t){return new kt(t,this.baseClient)}transaction(t,e){return new Dt(this.baseClient,t,e)}errorMonitor(t){return new _t(this.baseClient,t)}logger(){return new Pt(this.baseClient)}createClientForComponent(){const t=new Ot({baseClient:this.baseClient});return this.hooksManager.invoke(xt.afterCreateClientForComponent,t),t}}const Ut=t=>{var e;if(!(t instanceof Error))return{};const r=Ut(t.cause),n=t;return vt(r,{isWixHttpError:n.isWixHttpError,requestId:(null==(e=n.response)||null==(e=e.headers)?void 0:e["x-wix-request-id"])??n.requestId})},Lt=t=>vt(Ut(t),{isWixHttpError:!1,requestId:""}),Bt=32768,Ft=864e5,Ht=t=>{const{errorStack:e,sessionTime:r}=t;if(e&&e.length>Bt){const r="...[truncated by Panorama client to 32kb]",n=e.substring(0,Bt-r.length);t={...t,errorStack:`${n}${r}`}}return r&&r>Ft&&(t={...t,sessionTime:Ft}),t},Vt=t=>({sessionId:t.getSessionId(),sessionTime:Math.round(t.getSessionTime())}),jt=(t,e,r,n)=>{const{transactionName:o,transactionAction:a}=r,{sessionId:i,sessionTime:s}=Vt(t),c=Ct.Info,u=`Panorama ${o} ${a}`;return Ht({...e,...r,sessionId:i,sessionTime:s,logLevel:c,requestId:"",message:u,data:n})},Wt=(t,e,r,n)=>{const o=At.ComponentPhase,{phaseName:a,transactionAction:i}=r,{sessionId:s,sessionTime:c}=Vt(t),u=Ct.Info,l=`Panorama ${a} phase ${i}`;return Ht({...e,...r,transactionName:o,sessionId:s,sessionTime:c,logLevel:u,requestId:"",message:l,data:n})};class qt{constructor(t){var e=this;let{baseParams:r,globalConfig:n,reporter:o,hooksManager:a,data:i,isMuted:s}=t;it(this,"durationTracker",void 0),it(this,"baseParams",void 0),it(this,"globalConfig",void 0),it(this,"reporter",void 0),it(this,"hooksManager",void 0),it(this,"data",void 0),it(this,"isMuted",void 0),it(this,"getErrorMonitorDataWithDefaults",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.data.addDataScope(r).getData()}),this.baseParams=r,this.globalConfig=n,this.reporter=o,this.hooksManager=a,this.data=i,this.isMuted=s,this.durationTracker="function"==typeof n.getDurationTracker?n.getDurationTracker():mt()}report(t){if(this.isMuted())return;const e=this.globalConfig.getReporter(),r=this.hooksManager.invoke(xt.beforeReport,t);"function"!=typeof e?r&&this.reporter(t):e(t)}reportTransactionStart(t,e,r){void 0===e&&(e={});const{id:n}=e,o=this.data.addDataScope(r).getData();if(!this.hooksManager.invoke(xt.beforeReportTransactionStart,t,o))return;const{fullArtifactId:a,componentId:i}=this.baseParams;this.durationTracker.markTransactionStart(a,i,t,n);const s=jt(this.globalConfig,this.baseParams,{transactionName:t,transactionAction:Tt.Start},o);this.report(s),this.hooksManager.invoke(xt.afterReportTransactionStart,t,s)}reportTransactionFinish(t,e,r){void 0===e&&(e={});const{id:n}=e,o=this.data.addDataScope(r).getData();if(!this.hooksManager.invoke(xt.beforeReportTransactionFinish,t,o))return;const{fullArtifactId:a,componentId:i}=this.baseParams,s=this.durationTracker.markTransactionFinish(a,i,t,n),c=jt(this.globalConfig,this.baseParams,{transactionName:t,transactionAction:Tt.Finish,transactionDuration:s},o);this.report(c),this.hooksManager.invoke(xt.afterReportTransactionFinish,t,c)}reportPhaseStart(t,e){const r=this.data.addDataScope(e).getData();if(!this.hooksManager.invoke(xt.beforeReportPhaseStart,t,r))return;const{fullArtifactId:n,componentId:o}=this.baseParams;this.durationTracker.markPhaseStart(n,o,t);const a=Wt(this.globalConfig,this.baseParams,{phaseName:t,transactionAction:Tt.Start},r);this.report(a),this.hooksManager.invoke(xt.afterReportPhaseStart,t,a)}reportPhaseFinish(t,e){const r=this.data.addDataScope(e).getData();if(!this.hooksManager.invoke(xt.beforeReportPhaseFinish,t,r))return;const{fullArtifactId:n,componentId:o}=this.baseParams,a=this.durationTracker.markPhaseFinish(n,o,t),i=Wt(this.globalConfig,this.baseParams,{phaseName:t,transactionAction:Tt.Finish,transactionDuration:a},r);this.report(i),this.hooksManager.invoke(xt.afterReportPhaseFinish,t,i)}reportError(t,e,r){if(!(t instanceof Error))return;if(e=this.data.addDataScope([e,null==r?void 0:r.data]).getData(),!this.hooksManager.invoke(xt.beforeReportError,t,e,r))return;const n=((t,e,r,n)=>{const{sessionId:o,sessionTime:a}=Vt(t),{constructor:i,message:s,stack:c=""}=r,u=Ct.Error,{requestId:l}=Lt(r);return Ht({...e,sessionId:o,sessionTime:a,logLevel:u,requestId:l,data:n,errorName:(null==n?void 0:n.errorName)??i.name,errorStack:c,message:s})})(this.globalConfig,this.baseParams,t,e);this.report(n),this.hooksManager.invoke(xt.afterReportError,t,e,r)}addBreadcrumb(t){this.hooksManager.invoke(xt.beforeAddBreadcrumb,t)&&this.hooksManager.invoke(xt.afterAddBreadcrumb,t)}log(t,e,r){if(!e)return;const n=this.data.addDataScope(r).getData(),o={message:e,data:n,logLevel:t};if(!this.hooksManager.invoke(xt.beforeReportLog,t,e,n))return;const a=((t,e,r)=>{const{sessionId:n,sessionTime:o}=Vt(t);return Ht({...e,...r,sessionId:n,sessionTime:o,requestId:""})})(this.globalConfig,this.baseParams,o);this.report(a),this.hooksManager.invoke(xt.afterReportLog,t,e,n)}}class $t{constructor(t){it(this,"data",void 0),this.data=t}getEntriesToDeepDefaults(t){if(t)return Object.fromEntries(Object.entries(t).filter(t=>{let[e]=t;return $t.KEYS_TO_DEEP_DEFAULTS.includes(e)}))}addDataScope(t){const e=Array.isArray(t)?t:[t],r=Et(...e.map(t=>this.getEntriesToDeepDefaults(t)),this.getEntriesToDeepDefaults(this.data));return new $t(vt(r,...e,this.data))}getData(){return this.data}}it($t,"KEYS_TO_DEEP_DEFAULTS",["tags","context"]);class Xt{constructor(t){this.options=t,it(this,"globalConfig",void 0),it(this,"reporter",()=>!0),it(this,"plugins",[]),it(this,"isMuted",!1),st(this)}withGlobalConfig(t){return this.globalConfig=t,this}withReporter(t){return this.reporter=t,this}setMuted(t){return this.isMuted=t,this}use(t){return this.plugins.push(t),this}client(t){void 0===t&&(t={});const{pluginParams:e}=t,r=this.globalConfig??yt(),n=this.reporter,o=new Mt,a=vt(t.baseParams,this.options.baseParams),i=new $t(this.options.data).addDataScope(t.data),s=e??{},c=new qt({baseParams:a,globalConfig:r,isMuted:()=>this.isMuted,reporter:n,hooksManager:o,data:i}),u=new Nt({baseClient:c,hooksManager:o});return this.plugins.forEach(t=>t({hooksManager:o,globalConfig:r,reporter:n,baseClient:c,baseParams:a,pluginParams:s})),u}}let Kt=function(t){return t.HANDLED="HANDLED",t.UNHANDLED="UNHANDLED",t}({}),Gt=function(t){return t.WIX_SERVICE="WIX_SERVICE",t.WIX_APP="WIX_APP",t.WIX_CLI_APP="WIX_CLI_APP",t.WIX_CHAT="WIX_CHAT_WIDGET",t.BROWSER_EXTENSION="BROWSER_EXTENSION",t}({});const zt=[{scriptType:Gt.WIX_SERVICE,regex:()=>/\/services\/([^/]+)\/([^/]+)\//},{scriptType:Gt.WIX_APP,regex:()=>/apps\.wix\.com\/([^/]+)\//},{scriptType:Gt.WIX_CHAT,regex:()=>/unpkg-semver\/(wix-chatbot-widget)\//},{scriptType:Gt.BROWSER_EXTENSION,regex:()=>/^chrome-extension:/}],Jt=t=>{if(!t.module_metadata)return null;const{artifactId:e,fingerprint:r}=t.module_metadata;return{artifactId:e,artifactVersion:r,scriptType:Gt.WIX_CLI_APP}},Qt=t=>{const{filename:e,raw:r}=t,n=e??r;return n?zt.reduce((t,e)=>{let{scriptType:r,regex:o}=e;if(!t){const e=o().exec(n);if(e){const[,n,o]=e;t={artifactId:n,artifactVersion:o,scriptType:r}}}return t},null):null},Yt=t=>{return"string"!=typeof t?"":(e=t.split("."),(Array.isArray(e)?e[e.length-1]:void 0)||"");var e},Zt=(t,e)=>t.artifactId===e.artifactId,te=t=>{if("undefined"==typeof window)return null;return new URLSearchParams(window.location.search).get(t)},ee=t=>"true"===te(t);let re=function(t){return t.PRODUCTION="production",t.DEVELOPMENT="development",t.BOT="bot",t.INVALID_USER_AGENT="invalid_useragent",t.SLED="sled",t.SERVER="server",t.TEST="test",t}({});const ne=t=>{const e=Yt(t);if(!e)return!1;const r=te(`${e}-override`);if(r&&r.includes("localhost"))return!0;const n=(t=>{if("undefined"==typeof document)return null;const e=document.cookie.split(";").map(t=>t.trim()).find(t=>t.startsWith("wixStaticsVersions="));if(!e)return null;const r=e.split("=")[1].trim().split("|").find(e=>e.startsWith(`${t}#`));return r?r.split("#")[1]:null})(e);return!!n&&n.includes("localhost")};function oe(){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)return re.PRODUCTION;if("undefined"==typeof window)try{return"production"}catch{return re.SERVER}const{hostname:t}=window.location,{userAgent:e}=window.navigator,{cookie:r}=window.document,n=/(^|;)\s*automation\s*=\s*sled:/.test(r),o=/localhost|127\.0\.0\.1|::1|\.local|local\.wix\.com|^$/i.test(t),a=/Googlebot|AdsBot-Google-Mobile|bingbot|BingPreview|facebookexternalhit|Baiduspider|YandexBot/i.test(e),i=/BonEcho|NewsGator|SeaMonkey|iTunes|Epiphany|Konqueror|Sleipnir|IceWeasel/i.test(e);switch(!0){case n:return re.SLED;case o:return re.DEVELOPMENT;case a:return re.BOT;case i:return re.INVALID_USER_AGENT;default:return re.PRODUCTION}}const ae=(t,e,r,n,o)=>{const a=((t,e,r)=>["%c%s %c%s %c%s %c%s","color: #D39874","Panorama logger:","color: #CAB6D3",`${t}`,"color: #B3CAD8",`${e}`,"color: #A6C6DB",`${r}`])(e,r,n);t===Ct.Info?console.info(...a):t===Ct.Warn?console.warn(...a):t===Ct.Error?console.error(...a):t===Ct.Debug?console.debug(...a):console.log(...a),o&&Object.keys(o).length&&console.table(o)},ie=[re.DEVELOPMENT,re.SLED],se=()=>t=>{let{hooksManager:e,baseParams:{fullArtifactId:r,componentId:n}}=t;const o=oe(),a=ne(r),i=ee("enablePanoramaLogs"),s=(ie.includes(o)||a)&&!ee("forcePanoramaReport"),c=s&&i;c&&ae(Ct.Info,r,n,`Local mode detected${r?` for ${r}`:""}. Panorama will log reports in the console.`),e.tap(xt.beforeReport,t=>{const{data:e,message:r,fullArtifactId:n,componentId:o,logLevel:a}=t;if(c&&ae(a,n,o,r||"",e),s)return!1})};let ce=function(t){return t.REROUTE="REROUTE",t.CONTINUE="CONTINUE",t.DROP="DROP",t}({}),ue=function(t){return t.ERROR_IS_HANDLED="ERROR_IS_HANDLED",t.HANDLER_MATCH="HANDLER_MATCH",t.NO_ARTIFACTS_IN_STACKTRACE="NO_ARTIFACTS_IN_STACKTRACE",t.NO_REGISTERED_ARTIFACTS_IN_STACKTRACE="NO_REGISTERED_ARTIFACTS_IN_STACKTRACE",t.BLACKLISTED_SCRIPT_TYPE="BLACKLISTED_SCRIPT_TYPE",t.EXACT_REROUTE_MATCH="EXACT_REROUTE_MATCH",t.HANDLER_REROUTE_MATCH="HANDLER_REROUTE_MATCH",t.FALLBACK_REROUTE_MATCH="FALLBACK_REROUTE_MATCH",t}({});const le="__panoramaData",de=[Gt.BROWSER_EXTENSION],fe="sentryHubs",pe="sentryMainHub",he="sentryGlobalHub",ge=t=>(t.getStateValue(fe)||t.setStateValue(fe,new Map),t.getStateValue(fe)),me=t=>t.getStateValue(pe)??null,be=t=>t.getStateValue(he)??null,ye=(t,e)=>ge(e).get(t)??null,ve=t=>{const{artifactId:e,artifactVersion:r}=t;return`${e}@${r}`},Ee=t=>{if(!t)return[];const e=Object.values(t.getScope()??{}),r=["category","data","level","message","event_id","type"];try{for(const t of e){var n;if(Array.isArray(t)&&null!=(n=t[0])&&n.timestamp&&r.some(e=>{var r;return!(null==(r=t[0])||!r[e])}))return t}return[]}catch{return[]}},Ie=t=>{const e=[...Ee(be(t)),...Ee(me(t))].map(t=>{let e;try{t.data&&(e=Object.entries(t.data).reduce((t,e)=>{let[r,n]=e;return t[r]=Array.isArray(n)?n.map(t=>null==t?void 0:t.toString()):null==n?void 0:n.toString(),t},{}))}catch{}return{...t,...e?{data:e}:{}}});return e.slice(Math.max(0,e.length-100))};function Se(t,e){const{category:r}=t,n=r&&("ui.click"===r||"ui.input"===r),o=e&&e.event&&e.event.target;if(n&&o){const e=o.closest("[data-hook]");if(e){const r=e.getAttribute("data-hook");t.message=o===e?`${t.message} [data-hook="${r}"]`:`${t.message} parent:[data-hook="${r}"]`}}return t}const Ce=(t,e)=>(t.setContext(le,{...e,exceptionType:(null==e?void 0:e.exceptionType)||Kt.HANDLED}),null!=e&&e.severity&&t.setLevel(e.severity),t),Te=t=>{const{artifactData:e,stackTraceArtifactsData:r,panoramaData:n,globalConfig:o}=t,{exceptionType:a}=n;if(a===Kt.HANDLED)return{routingAction:ce.CONTINUE,routingActionReason:ue.ERROR_IS_HANDLED};if(0===r.length)return{routingAction:ce.CONTINUE,routingActionReason:ue.NO_ARTIFACTS_IN_STACKTRACE};if((t=>t.some(t=>{let{scriptType:e}=t;return de.includes(e)}))(r))return{routingAction:ce.DROP,routingActionReason:ue.BLACKLISTED_SCRIPT_TYPE};if(!((t,e)=>e.length>0&&t.artifactId!==e[0].artifactId)(e,r))return{routingAction:ce.CONTINUE,routingActionReason:ue.HANDLER_MATCH};const i=((t,e)=>{for(const r of t){const t=ye(r.artifactId,e);if(t)return{hub:t,artifactData:r}}return null})(r,o);if(!i)return{routingAction:ce.DROP,routingActionReason:ue.NO_REGISTERED_ARTIFACTS_IN_STACKTRACE};const{hub:s,artifactData:c}=i;if(Zt(e,c))return{routingAction:ce.CONTINUE,routingActionReason:ue.HANDLER_REROUTE_MATCH};const u=Zt(c,r[0])?ue.EXACT_REROUTE_MATCH:ue.FALLBACK_REROUTE_MATCH;return{routingAction:ce.REROUTE,routingActionReason:u,targetHub:s}},Ae=(t,e)=>{var r;const n=[],o=new Map,a=(null==(r=t.exception)||null==(r=r.values)||null==(r=r[0])||null==(r=r.stacktrace)?void 0:r.frames)||(t=>{if(!(t instanceof Error))return[];const{stack:e}=t;return(null==e?void 0:e.split("\n").map(t=>({raw:t})).reverse())||[]})(null==e?void 0:e.originalException);for(let t=a.length-1;t>=0;t--){const e=Jt(a[t])??Qt(a[t]);if(!e)continue;const{artifactId:r,artifactVersion:i}=e,s=r+i;o.has(s)||(o.set(s,!0),n.push(e))}return n},Re=(t,e,r)=>({hub:e(t),sentry:t,sentryBeforeSend:r}),we=t=>t.load(),_e=t=>!!t.hub,Pe=t=>{const{artifactData:e,pluginParams:r,globalConfig:n}=t,{sentryTransport:o,sentryDsn:a,sentryEnvironment:i}=r;let s,{sentry:c}=r;if(!c||!a)return{hub:null};const u=t=>{s=t},l=t=>{const r=!t.makeFetchTransport,n=r||o?o:t.makeFetchTransport,c=r?void 0:t.defaultStackParser,u=r?[...t.defaultIntegrations]:[...t.getDefaultIntegrations({}),..."function"==typeof t.moduleMetadataIntegration?[t.moduleMetadataIntegration()]:[]];return new t.Hub(new t.BrowserClient({dsn:a,environment:i??oe(),release:ve(e),transport:n,stackParser:c,integrations:u,normalizeDepth:4,beforeBreadcrumb:Se,beforeSend:(t,e)=>"function"==typeof s?s(t,e):t,debug:!0}))};return c=n.getStateValue("sentryResolved")??c,c.BrowserClient?Re(c,l,u):((t,e,r,n)=>{let o;const a=new Promise(t=>{o=t}),i={load:()=>(t.getStateValue("sentryLazyLoaderTriggered")||(t.setStateValue("sentryLazyLoaderTriggered",!0),e.forceLoad()),a),wait:()=>a,sentryBeforeSend:n};return e.onLoad(e=>{t.setStateValue("sentryResolved",e),o(Object.assign(i,Re(e,r,n)))}),i})(n,c,l,u)},De=(t,e)=>{const{artifactData:r,baseParams:n,pluginParams:o,globalConfig:a}=e,{fullArtifactId:i,componentId:s,uuid:c,msid:u}=n,{sentryDsn:l,sentryMain:d}=o,{artifactId:f}=r,p=t=>{const{hub:e,sentry:r}=t;if(e.setUser({id:c??""}),e.setTags({fullArtifactId:i,componentId:s,msid:u,sessionId:a.getSessionId()}),!me(a)&&d){if(!be(a)){const t=r.getCurrentHub();t.getClient()&&((t,e)=>{e.setStateValue(he,t)})(t,a)}r.makeMain(e),((t,e)=>{e.setStateValue(pe,t)})(e,a)}((t,e,r)=>{ge(r).set(e,t)})(e,f,a),((t,e,r)=>{ge(r).set(e,t)})(e,l,a)};_e(t)?p(t):(t=>t.wait())(t).then(p)},Oe=(t,e)=>{const{artifactData:r,pluginParams:n,baseClient:o,globalConfig:a,hooksManager:i}=e,{sentryBeforeSend:s}=t,c=(t=>(e,r)=>{if(!(e instanceof Error))return;const n={...r};delete n.originalErrorName;try{t.reportError(e,n)}catch(e){(t=>(e,r,n)=>{try{t.log(e,r,n)}catch(t){}})(t)(Ct.Error,"[panorama-sentry-plugin] Failed to report error to Panorama",{...n,error:null==e?void 0:e.toString()})}})(o);s((t,e)=>{const s=((t,e)=>{if(!(e instanceof Error)){const r=new Error("string"==typeof e?e:t.message);return delete r.stack,r}return e})(t,null==e?void 0:e.originalException);if((t=>{var e;return!(null!=(e=t.contexts)&&e[le])})(t)&&!i.invoke(xt.beforeUnhandledError,s))return null;const u=Ae(t,e);let l=(t=>{var e;let r={};return null!=(e=t.contexts)&&e[le]&&(r={...r,...t.contexts[le]},delete t.contexts[le]),r.exceptionType=r.exceptionType||Kt.UNHANDLED,r})(t);const{routingAction:d}=l;let f=!1,p=!1;if(d===ce.REROUTE)f=!0,p=!0;else{const{routingAction:e,routingActionReason:n,targetHub:o}=Te({artifactData:r,stackTraceArtifactsData:u,panoramaData:l,globalConfig:a});switch(l={...l,routingAction:e,routingActionReason:n},e){case ce.REROUTE:f=!1,p=!1,o.withScope(e=>{var n;Ce(e,{...l,originalHandler:r,originalErrorName:null==(n=t.exception)||null==(n=n.values)||null==(n=n[0])?void 0:n.type}),o.captureException((t=>{const{message:e,stack:r,cause:n}=t;return Object.assign(Object.create(Object.getPrototypeOf(t)),{name:`${Date.now()+Math.random()}`,message:e,stack:r,cause:n})})(s))});break;case ce.CONTINUE:f=!0,p=!0;break;case ce.DROP:f=!0,p=!1}}return f&&(l=((t,e,r)=>{let{stackTraceArtifactsData:n}=r;return{...t,externalId:e.event_id,environment:t.environment??e.environment,stackTraceArtifacts:n}})(l,t,{stackTraceArtifactsData:u}),c(s,l)),p?(n.sentryGetReleaseFromStacktrace&&(t=((t,e,r)=>{const n=((t,e)=>{for(const r of e){const{artifactId:e}=r;if(e===t.artifactId)return r}return null})(e,r);if(!n)return t;const o=ve(n);return{...t,release:o}})(t,r,u)),t=((t,e)=>({...t,breadcrumbs:Ie(e)}))(t,a),t=((t,e,r)=>{var n;const o=r.getErrorMonitorDataWithDefaults({tags:{exceptionType:e.exceptionType}},{tags:e.tags,context:e.context,environment:e.environment},{tags:t.tags,context:t.contexts,environment:t.environment});return t={...t,tags:null==o?void 0:o.tags,contexts:null==o?void 0:o.context,environment:null==o?void 0:o.environment},e.originalErrorName&&null!=(n=t.exception)&&null!=(n=n.values)&&n[0]&&(t.exception.values[0].type=e.originalErrorName),t})(t,l,o),t=((t,e)=>{const{requestId:r}=Lt(e);return{...t,tags:{...t.tags,...r?{requestId:r}:{}}}})(t,s),t):null}),i.tap(xt.beforeReportError,(e,r,n)=>{if(null!=r&&r.externalId)return;const o=t=>{let o=t.hub;const{sentryLookupDsn:i,sentryEnvironment:s}=(null==n?void 0:n.pluginParams)??{};if(i){const t=((t,e)=>ge(e).get(t)??null)(i,a);t&&(o=t)}o.withScope(t=>{Ce(t,vt(r,{environment:s})),o.captureException(e)})};return _e(t)?o(t):we(t).then(o),!1}),i.tap(xt.beforeAddBreadcrumb,e=>{const r=()=>{const t=be(a)??me(a);null==t||t.addBreadcrumb(e)};_e(t)?r():we(t).then(r)})},xe=function(t){return void 0===t&&(t={}),e=>{let{baseParams:r,pluginParams:n,baseClient:o,hooksManager:a,globalConfig:i}=e;n=vt(n,t);const s=(t=>{const{fullArtifactId:e,artifactVersion:r}=t;return{artifactId:Yt(e),artifactVersion:r,scriptType:Gt.WIX_SERVICE}})(r),c=Pe({artifactData:s,pluginParams:n,globalConfig:i});(t=>null===t.hub)(c)||(De(c,{artifactData:s,baseParams:r,pluginParams:n,globalConfig:i}),Oe(c,{artifactData:s,pluginParams:n,baseClient:o,hooksManager:a,globalConfig:i}))}};var Me=c(72527),ke=c.n(Me);class Ne{constructor(t){this.options=t,it(this,"queue",[]),it(this,"flushThrottled",void 0),this.flushThrottled=ke()(()=>this.flush(),t.throttleDuration,{leading:!1})}flush(){const t=this.queue.splice(0);this.options.flushHandler(t)}enqueue(t){this.queue.push(t),this.queue.length===this.options.maxBatchSize?(this.flushThrottled.cancel(),this.flush()):this.flushThrottled()}}const Ue=100,Le=["dataCenter","isCached","isRollout","isDacRollout","isSavRollout","isHeadless","isSsr"],Be=(t,e)=>r=>{try{const n=Array.isArray(r)?r:[r],o=JSON.stringify({messages:n}),a={method:"POST",body:o};if(e)return e(t,a).catch(t=>{console.error(t)}),!0;const i=navigator.sendBeacon(t,o);return i||(fetch(t,a),((t,e)=>{var r,n;const o=new URL("https://frog.wix.com/panorama"),a=t.length,i=e.length,s=t.map(t=>{let{logLevel:e,fullArtifactId:r,componentId:n,message:o}=t;return[e,r,n,o].join("|")}).join(",");[["src",11],["evid",114700],["sessionId",null==(r=t[0])?void 0:r.sessionId],["platform",null==(n=t[0])?void 0:n.platform],["batchLength",a],["batchSize",i],["batchItems",s],["_",Date.now()]].forEach(t=>{let[e,r]=t;return o.searchParams.set(e,(r??"").toString())}),(new Image).src=o.toString()})(n,o),!0)}catch(t){return console.error(t),!1}},Fe=t=>{const{baseParams:e,pluginParams:r,pageParams:n,data:o,reporterOptions:a}=t,{useBatch:i=!0,sentry:s,sentryDsn:c,sentryMain:u,sentryEnvironment:l,sentryTransport:d}=r??{},{fetchFn:f}=a??{},p=function(t){return void 0===t&&(t={}),new Xt(t)}({baseParams:e,data:o}).use(function(t){return void 0===t&&(t={}),e=>{let{hooksManager:r}=e;const{pageUrl:n}=t;r.tap(xt.beforeReport,t=>{(n||"undefined"!=typeof window)&&(t.httpReferrer=n??window.location.href)})}}(n)).use((h=Le,t=>{let{hooksManager:e}=t;e.tap(xt.beforeReport,t=>{h.forEach(e=>{const{data:r}=t;r&&void 0!==r[e]&&(t[e]=r[e],r[e]=void 0)})})})).use(se()).use(xe({sentry:s,sentryDsn:c,sentryMain:u,sentryEnvironment:l,sentryTransport:d})).withReporter(Be("https://panorama.wixapps.net/api/v1/bulklog",f));var h;return i&&p.use(function(t,e){return void 0===e&&(e={}),r=>{let{hooksManager:n,globalConfig:o,reporter:a}=r;if(o.getReporter())return;const{maxBatchSize:i=Ue}=e;o.initBatchQueue(new Ne({throttleDuration:t,maxBatchSize:i,flushHandler:a})),n.tap(xt.beforeReport,t=>(o.getBatchQueue().enqueue(t),!1))}}(300)),p.use=void 0,p};var He=c(41619),Ve=c.n(He);const je=yt(),We=({environment:t,metaSiteId:e,userId:r,componentId:n,experiments:o,muted:a,sentryDsn:i})=>{const s=function(){if("undefined"!=typeof window)return window;throw Error("window is unavailable")}().__PANORAMA_SESSION_ID__;return s&&je.setSessionId(s),Fe({baseParams:{platform:"BUSINESS_MANAGER"===t?Rt.BusinessManager:Rt.Editor,fullArtifactId:"com.wixpress.core3.auto-cms-v2",componentId:n,appDefId:"9f87f125-e7d5-4ed9-a16c-999d862e96ab",artifactVersion:"725b994316eff054004f6c1420196a261339d41966b695a5f3e6c099",msid:e,uuid:r,experiments:o},data:{...window.commonConfig,origin}}).withGlobalConfig(je).setMuted(a||!1).client({pluginParams:{sentry:Ve(),sentryDsn:i}})};function qe({metaSiteId:t,userId:r}){const n=We({environment:"BUSINESS_MANAGER",componentId:"wix-databases-lazy-page-component-id",metaSiteId:t,userId:r,sentryDsn:"https://d0b92161fdd9403abc48b254b209d6fc@sentry-next.wixpress.com/8153"});n.reportLoadStart(),e.ModuleRegistry.registerMethod(a.jm,()=>()=>n)}(0,t.registerModule)(t.ModuleId.WixCodeDatabase,class extends t.BusinessManagerModule{register(){this.registerComponentWithModuleParams(a.Tq,u.AutoCMSLazyPageComponent),s(),e.ModuleRegistry.registerMethod(a.EV,()=>nt),e.ModuleRegistry.registerMethod(a.$0,()=>qe)}})})(),{}})());
//# sourceMappingURL=auto-cms-bm-module.js.map